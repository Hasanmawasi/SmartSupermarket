<div class="main-log">
<div class="log-container ">
    <h2>Daily Log</h2>
    <p class="description">Submit your arrival and departure times. Please wait for admin approval after each submission.</p>
    <form action="/worker/submitArrival" method="POST">
      <input type="hidden" name="type" value="arrival">
      <% if (locals.a_status){ %>
        <button id="arrivalButton" class="log-button" disabled>
          <i class="fas fa-sign-out-alt"></i> <%= locals.a_status %>
        </button>
        <% } else { %>
        <button id="arrivalButton" class="log-button" >
        <i class="fas fa-sign-out-alt"></i> Log Arrival
        </button>
        <% } %>
    </form>
    <form action="/worker/submitDeparture" method="POST">
      <input type="hidden" name="type" value="departure">
    <% if (locals.d_status){ %>
      <button id="departureButton" class="log-button" disabled>
        <i class="fas fa-sign-out-alt"></i> <%= locals.d_status %>
      </button>
      <% } else { %>
      <button id="arrivalButton" class="log-button" >
      <i class="fas fa-sign-out-alt"></i> Log Departure
      </button>
      <% } %>
    </button>
    </form>
    <% if (locals.message){ %>
        <div id="statusMessage" class="status pending">Status: <%= message %></div>
    <% } else {%>
        <div id="statusMessage" class="status pending">Status: Awaiting arrival log</div>
    <% } %>
  </div>

  <div class="schedule-container">
    <div class="schedule-heading">Weekly Work Schedule</div>
    <table>
        <thead>
            <tr>
                <th>Day</th>
                <th>Shift Start</th>
                <th>Shift End</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Monday</td>
                <td>09:00 AM</td>
                <td>05:00 PM</td>
                <td><span class="badge badge-available">Available</span></td>
            </tr>
            <tr>
                <td>Tuesday</td>
                <td>09:00 AM</td>
                <td>05:00 PM</td>
                <td><span class="badge badge-available">Available</span></td>
            </tr>
            <tr>
                <td>Wednesday</td>
                <td>09:00 AM</td>
                <td>05:00 PM</td>
                <td><span class="badge badge-available">Available</span></td>
            </tr>
            <tr>
                <td>Thursday</td>
                <td>09:00 AM</td>
                <td>01:00 PM</td>
                <td><span class="badge badge-halfday">Half Day</span></td>
            </tr>
            <tr>
                <td>Friday</td>
                <td>09:00 AM</td>
                <td>05:00 PM</td>
                <td><span class="badge badge-available">Available</span></td>
            </tr>
            <tr>
                <td>Saturday</td>
                <td colspan="2">-</td>
                <td><span class="badge badge-off">Off</span></td>
            </tr>
            <tr>
                <td>Sunday</td>
                <td colspan="2">-</td>
                <td><span class="badge badge-off">Off</span></td>
            </tr>
        </tbody>
    </table>
</div>
</div>
<script src="/socket.io/socket.io.js"></script>
<script>
    const socket = io();
    socket.on('accepted-login',(response)=>{
        const notificationSound = new Audio('/sounds/mixkit-software-interface-back-2575.mp3'); // Path to your sound file
        notificationSound.play().catch((error) => {
       console.error("Audio playback failed:", error);
       });
        let arrivalbtn = document.getElementById('arrivalButton');
        let message= document.getElementById("statusMessage")          
        if(response == 'accepted'){
            arrivalbtn.innerHTML = "accepted";
            message.innerHTML='Arrival log is Accepted'
        }
    });

    socket.on('accepted-departure',(response)=>{
        const notificationSound = new Audio('/sounds/mixkit-software-interface-back-2575.mp3'); // Path to your sound file
      notificationSound.play().catch((error) => {
      console.error("Audio playback failed:", error);
     });
        let departurebtn = document.getElementById('departureButton')
        let message= document.getElementById("statusMessage") 
        if(response == 'accepted'){
            departurebtn.innerHTML = "accepted";
             message.innerHTML='Departure log is Accepted'
        }
    });

</script>